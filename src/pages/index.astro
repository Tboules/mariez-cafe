---
import { getFirestore } from "firebase-admin/firestore";
import Layout from "../layouts/Layout.astro";
import { app } from "../firebase/server";
import type { MenuItem } from "../types";

const db = getFirestore(app);

const menuItemsRef = db.collection('menuItems');

const menuItemsSnapshot = await menuItemsRef.get()
const menuItems: MenuItem[] = [];

menuItemsSnapshot.forEach((doc) => {
  const menuItem = {
    ...doc.data(),
    id: doc.id
  } as MenuItem


  menuItems.push(menuItem)
})
---

<Layout title="Mariez' Cafe">
  <h1>Mariez' Cafe</h1>
  
  <ul class='menu-item-list'>
    {menuItems.map(item => (
      <li class='menu-item'>
        <a href={`/order?drinkId=${item.id}`}>
          <h3>{item.name}</h3>
          <p>{item.description}</p>
        </a>
      </li>
    ))}
  </ul>

    
</Layout>

<style>
  .menu-item-list {
    display: grid;
    list-style-type: none;
    grid-template-columns: repeat(3, 1fr);
    gap: 1rem;
  }


  .menu-item {
    border: 1px solid black;
    border-radius: .25rem;
  }

  .menu-item a {
    box-sizing: border-box;
    padding: 1rem;
    color: black;
    display: block;
    width: 100%;
    height: 100%;
    text-decoration: none;
  }
</style>

<script>
  import { collection, addDoc } from "firebase/firestore";
</script>
